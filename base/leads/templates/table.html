{% extends "base.html" %}

{% block content %}



  <h1 class="text-center mb-4">ERROR DE PAGO LEADS</h1>

  
  <div class="row">
    <div class="col">
      <form method="get" class="form-inline align-items-center">
        <div class="form-group mr-2">
          <label for="order-by">Ordenar Por:</label>
          <select class="form-control" id="order-by" name="option">
            <option value="recent"{% if request.GET.option == 'recent' %} selected{% endif %}>Agregados Más Recientes</option>
            <option value="old"{% if request.GET.option == 'old' %} selected{% endif %}>Agregados Más Antiguos</option>
            <option value="unassigned"{% if request.GET.option == 'unassigned' %} selected{% endif %}>Sin Asignar</option>
            <option value="assigned"{% if request.GET.option == 'assigned' %} selected{% endif %}>Asignados</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary">Ordenar</button>
      </form>
    </div>
  </div>
  {% for message in messages %}
  <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %} {% if message.level_tag == 'error' %}alert-danger{% endif %}" role="alert">
    {{ message }}
  </div>
{% endfor %}
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Fecha y hora</th>
        <th>Número</th>
        <th>WhatsApp  <i class="fab fa-whatsapp" style="color: green;"></i></th>
        <th>Closer</th>
        <th>Acción</th>
      </tr>
    </thead>
    <tbody>
      {% for lead in leads %}
        <tr>
          <td>{{ lead.nombre }}</td>
          <td style="max-width: 20px;">{{ lead.fecha_hora|date:"d/m/Y H:i" }}</td>
          <td>{{ lead.numero }}</td>
          <td style="max-width: 50px;">
            {% if lead.numero %}
              <a href="https://wa.me/{{ lead.numero }}" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                <i class="fab fa-whatsapp" style="color: green;"></i>
                <span style="color: green;">Hablar al WhatsApp</span>
              </a>
            {% else %}
              -
            {% endif %}
          </td>
          <td>{% if lead.closer %}{{ lead.closer }}{% else %}-{% endif %}</td>
          <td>
            {% if lead.closer %}
              <button type="button" class="btn btn-warning disabled">Asignado</button>
            {% else %}
              <form method="post">
                {% csrf_token %}
                <input type="hidden" name="lead_id" value="{{ lead.id }}">
                <button type="submit" class="btn btn-primary">Asignar</button>
              </form>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}


